!function(t,e){for(var n in e)t[n]=e[n]}(exports,function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=35)}([,function(t,e,n){"use strict";var r=n(2);function i(t,e){Error.call(this),this.name=t,this.message=e}function o(t){i.call(this,"InvalidValue",t)}function s(t,e,n){i.call(this,"InvalidArity","Function requires "+function(t,e){return null===e?"at least "+t:null===t?"up to "+e:t===e?t:"from "+t+" to "+e}(t,e)+" arguments but "+n+" were given."),this.min=t,this.max=e,this.actual=n}function u(t,e){var n=e.responseContent.errors,r=0===n.length?'(empty "errors")':n[0].code;i.call(this,t,r),this.requestResult=e}function a(t){u.call(this,"BadRequest",t)}function c(t){u.call(this,"Unauthorized",t)}function l(t){u.call(this,"PermissionDenied",t)}function f(t){u.call(this,"NotFound",t)}function h(t){u.call(this,"MethodNotAllowed",t)}function p(t){u.call(this,"InternalError",t)}function d(t){u.call(this,"UnavailableError",t)}r.inherits(i,Error),r.inherits(o,i),r.inherits(s,i),r.inherits(u,i),u.prototype.errors=function(){return this.requestResult.responseContent.errors},u.raiseForStatusCode=function(t){var e=t.statusCode;if(e<200||e>=300)switch(e){case 400:throw new a(t);case 401:throw new c(t);case 403:throw new l(t);case 404:throw new f(t);case 405:throw new h(t);case 500:throw new p(t);case 503:throw new d(t);default:throw new u("UnknownError",t)}},r.inherits(a,u),r.inherits(c,u),r.inherits(l,u),r.inherits(f,u),r.inherits(h,u),r.inherits(p,u),r.inherits(d,u),t.exports={FaunaHTTPError:u,InvalidValue:o,InvalidArity:s,BadRequest:a,Unauthorized:c,PermissionDenied:l,NotFound:f,MethodNotAllowed:h,InternalError:p,UnavailableError:d}},function(t,e){t.exports=require("util")},function(t,e,n){"use strict";var r=n(18),i=n(6),o=n(1),s=n(5),u=n(2),a=u&&u.inspect&&u.inspect.custom,c=u&&u.inspect||JSON.stringify;function l(){}function f(t,e,n){if(!t)throw new o.InvalidValue("id cannot be null or undefined");this.value={id:t},e&&(this.value.collection=e),n&&(this.value.database=n)}u.inherits(l,s),u.inherits(f,l),Object.defineProperty(f.prototype,"collection",{get:function(){return this.value.collection}}),Object.defineProperty(f.prototype,"class",{get:i(function(){return this.value.collection},"class is deprecated, use collection instead")}),Object.defineProperty(f.prototype,"database",{get:function(){return this.value.database}}),Object.defineProperty(f.prototype,"id",{get:function(){return this.value.id}}),f.prototype.toJSON=function(){return{"@ref":this.value}},v(f,function(){var t={collections:"Collection",databases:"Database",indexes:"Index",functions:"Function",roles:"Role"},e=function(n,r){if(void 0===n.collection&&void 0===n.database)return n.id.charAt(0).toUpperCase()+n.id.slice(1)+"("+r+")";var i=t[n.collection.id];if(void 0!==i){var o=void 0!==n.database?", "+n.database.toString():"";return i+'("'+n.id+'"'+o+")"}o=void 0!==n.database?n.database.toString():"";return"Ref("+e(n.collection,o)+', "'+n.id+'")'};return e(this,"")}),f.prototype.valueOf=function(){return this.value},f.prototype.equals=function(t){return t instanceof f&&this.id===t.id&&(void 0===this.collection&&void 0===t.collection||this.collection.equals(t.collection))&&(void 0===this.database&&void 0===t.database||this.database.equals(t.database))};var h={COLLECTIONS:new f("collections"),INDEXES:new f("indexes"),DATABASES:new f("databases"),FUNCTIONS:new f("functions"),ROLES:new f("roles"),KEYS:new f("keys")};function p(t){this.value=t}function d(t){if(t instanceof Date)t=t.toISOString();else if("Z"!==t.charAt(t.length-1))throw new o.InvalidValue("Only allowed timezone is 'Z', got: "+t);this.value=t}function w(t){t instanceof Date&&(t=t.toISOString().slice(0,10)),this.value=t}function m(t){if(t instanceof ArrayBuffer)this.value=new Uint8Array(t);else if("string"==typeof t)this.value=r.toByteArray(t);else{if(!(t instanceof Uint8Array))throw new o.InvalidValue("Bytes type expect argument to be either Uint8Array|ArrayBuffer|string, got: "+c(t));this.value=t}}function y(t){this.value=t}function v(t,e){t.prototype.toString=e,t.prototype.inspect=e,a&&(t.prototype[a]=e)}h.fromName=function(t){switch(t){case"collections":return h.COLLECTIONS;case"indexes":return h.INDEXES;case"databases":return h.DATABASES;case"functions":return h.FUNCTIONS;case"roles":return h.ROLES;case"keys":return h.KEYS}return new f(t)},u.inherits(p,l),v(p,function(){return"SetRef("+c(this.value)+")"}),p.prototype.toJSON=function(){return{"@set":this.value}},u.inherits(d,l),Object.defineProperty(d.prototype,"date",{get:function(){return new Date(this.value)}}),v(d,function(){return'Time("'+this.value+'")'}),d.prototype.toJSON=function(){return{"@ts":this.value}},u.inherits(w,l),Object.defineProperty(w.prototype,"date",{get:function(){return new Date(this.value)}}),v(w,function(){return'Date("'+this.value+'")'}),w.prototype.toJSON=function(){return{"@date":this.value}},u.inherits(m,l),v(m,function(){return'Bytes("'+r.fromByteArray(this.value)+'")'}),m.prototype.toJSON=function(){return{"@bytes":r.fromByteArray(this.value)}},u.inherits(y,l),v(y,function(){return"Query("+s.toString(this.value)+")"}),y.prototype.toJSON=function(){return{"@query":this.value}},t.exports={Value:l,Ref:f,Native:h,SetRef:p,FaunaTime:d,FaunaDate:w,Bytes:m,Query:y}},function(t,e,n){"use strict";var r=n(17),i=n(6),o=n(5),s=n(1),u=n(3),a=n(7);function c(t){return h.exact(1,arguments),new o({var:y(t)})}function l(){switch(h.between(1,2,arguments),arguments.length){case 1:var t=arguments[0];if("function"==typeof t)return function(t){var e=r(t);switch(e.length){case 0:throw new s.InvalidValue("Provided Function must take at least 1 argument.");case 1:return f(e[0],t(c(e[0])));default:return f(e,t.apply(null,e.map(function(t){return c(t)})))}}(t);if(t instanceof o)return t;throw new s.InvalidValue("Lambda function takes either a Function or an Expr.");case 2:return f(arguments[0],arguments[1])}}function f(t,e){return new o({lambda:y(t),expr:y(e)})}function h(t,e,n){if(null!==t&&n.length<t||null!==e&&n.length>e)throw new s.InvalidArity(t,e,n.length)}function p(t,e){for(var n in e){var r=e[n];null!==r&&(t[n]=r)}return t}function d(t){var e=Array.isArray(t)?t:Array.prototype.slice.call(t);return 1===t.length?t[0]:e}function w(t){var e=[];return e.push.apply(e,t),e}function m(t,e){return void 0===t?e:t}function y(t){return h.exact(1,arguments),null===t?null:t instanceof o?t:"symbol"==typeof t?t.toString().replace(/Symbol\((.*)\)/,function(t,e){return e}):"function"==typeof t?l(t):Array.isArray(t)?new o(t.map(function(t){return y(t)})):t instanceof Uint8Array||t instanceof ArrayBuffer?new u.Bytes(t):"object"==typeof t?new o({object:v(t)}):t}function v(t){if(null!==t){var e={};return Object.keys(t).forEach(function(n){e[n]=y(t[n])}),e}return null}h.exact=function(t,e){h(t,t,e)},h.max=function(t,e){h(null,t,e)},h.min=function(t,e){h(t,null,e)},h.between=function(t,e,n){h(t,e,n)},t.exports={Ref:function(){switch(h.between(1,2,arguments),arguments.length){case 1:return new o({"@ref":y(arguments[0])});case 2:return new o({ref:y(arguments[0]),id:y(arguments[1])})}},Bytes:function(t){return h.exact(1,arguments),new u.Bytes(t)},Abort:function(t){return h.exact(1,arguments),new o({abort:y(t)})},At:function(t,e){return h.exact(2,arguments),new o({at:y(t),expr:y(e)})},Let:function(t,e){h.exact(2,arguments);var n=[];if(n=Array.isArray(t)?t.map(function(t){return v(t)}):Object.keys(t).map(function(e){var n={};return n[e]=y(t[e]),n}),"function"==typeof e)if(Array.isArray(t)){var r=[];t.forEach(function(t){Object.keys(t).forEach(function(t){r.push(c(t))})}),e=e.apply(null,r)}else e=e.apply(null,Object.keys(t).map(function(t){return c(t)}));return new o({let:n,in:y(e)})},Var:c,If:function(t,e,n){return h.exact(3,arguments),new o({if:y(t),then:y(e),else:y(n)})},Do:function(){h.min(1,arguments);var t=w(arguments);return new o({do:y(t)})},Object:function(t){return h.exact(1,arguments),new o({object:v(t)})},Lambda:l,Call:function(t){h.min(1,arguments);var e=w(arguments);return e.shift(),new o({call:y(t),arguments:y(d(e))})},Query:function(t){return h.exact(1,arguments),new o({query:y(t)})},Map:function(t,e){return h.exact(2,arguments),new o({map:y(e),collection:y(t)})},Foreach:function(t,e){return h.exact(2,arguments),new o({foreach:y(e),collection:y(t)})},Filter:function(t,e){return h.exact(2,arguments),new o({filter:y(e),collection:y(t)})},Take:function(t,e){return h.exact(2,arguments),new o({take:y(t),collection:y(e)})},Drop:function(t,e){return h.exact(2,arguments),new o({drop:y(t),collection:y(e)})},Prepend:function(t,e){return h.exact(2,arguments),new o({prepend:y(t),collection:y(e)})},Append:function(t,e){return h.exact(2,arguments),new o({append:y(t),collection:y(e)})},IsEmpty:function(t){return h.exact(1,arguments),new o({is_empty:y(t)})},IsNonEmpty:function(t){return h.exact(1,arguments),new o({is_nonempty:y(t)})},Get:function(t,e){return h.between(1,2,arguments),e=m(e,null),new o(p({get:y(t)},{ts:y(e)}))},KeyFromSecret:function(t){return h.exact(1,arguments),new o({key_from_secret:y(t)})},Paginate:function(t,e){return h.between(1,2,arguments),e=m(e,{}),new o(a({paginate:y(t)},v(e)))},Exists:function(t,e){return h.between(1,2,arguments),e=m(e,null),new o(p({exists:y(t)},{ts:y(e)}))},Create:function(t,e){return h.between(1,2,arguments),new o({create:y(t),params:y(e)})},Update:function(t,e){return h.exact(2,arguments),new o({update:y(t),params:y(e)})},Replace:function(t,e){return h.exact(2,arguments),new o({replace:y(t),params:y(e)})},Delete:function(t){return h.exact(1,arguments),new o({delete:y(t)})},Insert:function(t,e,n,r){return h.exact(4,arguments),new o({insert:y(t),ts:y(e),action:y(n),params:y(r)})},Remove:function(t,e,n){return h.exact(3,arguments),new o({remove:y(t),ts:y(e),action:y(n)})},CreateClass:i(function(t){return h.exact(1,arguments),new o({create_class:y(t)})},"CreateClass() is deprecated, use CreateCOllection() instead"),CreateCollection:function(t){return h.exact(1,arguments),new o({create_collection:y(t)})},CreateDatabase:function(t){return h.exact(1,arguments),new o({create_database:y(t)})},CreateIndex:function(t){return h.exact(1,arguments),new o({create_index:y(t)})},CreateKey:function(t){return h.exact(1,arguments),new o({create_key:y(t)})},CreateFunction:function(t){return h.exact(1,arguments),new o({create_function:y(t)})},CreateRole:function(t){return h.exact(1,arguments),new o({create_role:y(t)})},Singleton:function(t){return h.exact(1,arguments),new o({singleton:y(t)})},Events:function(t){return h.exact(1,arguments),new o({events:y(t)})},Match:function(t){h.min(1,arguments);var e=w(arguments);return e.shift(),new o({match:y(t),terms:y(d(e))})},Union:function(){return h.min(1,arguments),new o({union:y(d(arguments))})},Intersection:function(){return h.min(1,arguments),new o({intersection:y(d(arguments))})},Difference:function(){return h.min(1,arguments),new o({difference:y(d(arguments))})},Distinct:function(t){return h.exact(1,arguments),new o({distinct:y(t)})},Join:function(t,e){return h.exact(2,arguments),new o({join:y(t),with:y(e)})},Login:function(t,e){return h.exact(2,arguments),new o({login:y(t),params:y(e)})},Logout:function(t){return h.exact(1,arguments),new o({logout:y(t)})},Identify:function(t,e){return h.exact(2,arguments),new o({identify:y(t),password:y(e)})},Identity:function(){return h.exact(0,arguments),new o({identity:null})},HasIdentity:function(){return h.exact(0,arguments),new o({has_identity:null})},Concat:function(t,e){return h.min(1,arguments),e=m(e,null),new o(p({concat:y(t)},{separator:y(e)}))},Casefold:function(t,e){return h.min(1,arguments),new o(p({casefold:y(t)},{normalizer:y(e)}))},FindStr:function(t,e,n){return h.between(2,3,arguments),n=m(n,null),new o(p({findstr:y(t),find:y(e)},{start:y(n)}))},FindStrRegex:function(t,e,n,r){return h.between(2,4,arguments),n=m(n,null),new o(p({findstrregex:y(t),pattern:y(e)},{start:y(n),num_results:y(r)}))},Length:function(t){return h.exact(1,arguments),new o({length:y(t)})},LowerCase:function(t){return h.exact(1,arguments),new o({lowercase:y(t)})},LTrim:function(t){return h.exact(1,arguments),new o({ltrim:y(t)})},NGram:function(t,e,n){return h.between(1,3,arguments),e=m(e,null),n=m(n,null),new o(p({ngram:y(t)},{min:y(e),max:y(n)}))},Repeat:function(t,e){return h.between(1,2,arguments),e=m(e,null),new o(p({repeat:y(t)},{number:y(e)}))},ReplaceStr:function(t,e,n){return h.exact(3,arguments),new o({replacestr:y(t),find:y(e),replace:y(n)})},ReplaceStrRegex:function(t,e,n,r){return h.between(3,4,arguments),r=m(r,null),new o(p({replacestrregex:y(t),pattern:y(e),replace:y(n)},{first:y(r)}))},RTrim:function(t){return h.exact(1,arguments),new o({rtrim:y(t)})},Space:function(t){return h.exact(1,arguments),new o({space:y(t)})},SubString:function(t,e,n){return h.between(1,3,arguments),e=m(e,null),n=m(n,null),new o(p({substring:y(t)},{start:y(e),length:y(n)}))},TitleCase:function(t){return h.exact(1,arguments),new o({titlecase:y(t)})},Trim:function(t){return h.exact(1,arguments),new o({trim:y(t)})},UpperCase:function(t){return h.exact(1,arguments),new o({uppercase:y(t)})},Time:function(t){return h.exact(1,arguments),new o({time:y(t)})},Epoch:function(t,e){return h.exact(2,arguments),new o({epoch:y(t),unit:y(e)})},Date:function(t){return h.exact(1,arguments),new o({date:y(t)})},NextId:i(function(){return h.exact(0,arguments),new o({next_id:null})},"NextId() is deprecated, use NewId() instead"),NewId:function(){return h.exact(0,arguments),new o({new_id:null})},Database:function(t,e){switch(h.between(1,2,arguments),arguments.length){case 1:return new o({database:y(t)});case 2:return new o({database:y(t),scope:y(e)})}},Index:function(t,e){switch(h.between(1,2,arguments),arguments.length){case 1:return new o({index:y(t)});case 2:return new o({index:y(t),scope:y(e)})}},Class:i(function(t,e){switch(h.between(1,2,arguments),arguments.length){case 1:return new o({class:y(t)});case 2:return new o({class:y(t),scope:y(e)})}},"Class() is deprecated, use Collection() instead"),Collection:function(t,e){switch(h.between(1,2,arguments),arguments.length){case 1:return new o({collection:y(t)});case 2:return new o({collection:y(t),scope:y(e)})}},Function:function(t,e){switch(h.between(1,2,arguments),arguments.length){case 1:return new o({function:y(t)});case 2:return new o({function:y(t),scope:y(e)})}},Role:function(t,e){return h.between(1,2,arguments),e=m(e,null),new o(p({role:y(t)},{scope:y(e)}))},Classes:i(function(t){return h.max(1,arguments),t=m(t,null),new o({classes:y(t)})},"Classes() is deprecated, use Collections() instead"),Collections:function(t){return h.max(1,arguments),t=m(t,null),new o({collections:y(t)})},Databases:function(t){return h.max(1,arguments),t=m(t,null),new o({databases:y(t)})},Indexes:function(t){return h.max(1,arguments),t=m(t,null),new o({indexes:y(t)})},Functions:function(t){return h.max(1,arguments),t=m(t,null),new o({functions:y(t)})},Roles:function(t){return h.max(1,arguments),t=m(t,null),new o({roles:y(t)})},Keys:function(t){return h.max(1,arguments),t=m(t,null),new o({keys:y(t)})},Tokens:function(t){return h.max(1,arguments),t=m(t,null),new o({tokens:y(t)})},Credentials:function(t){return h.max(1,arguments),t=m(t,null),new o({credentials:y(t)})},Equals:function(){return h.min(1,arguments),new o({equals:y(d(arguments))})},Contains:function(t,e){return h.exact(2,arguments),new o({contains:y(t),in:y(e)})},Select:function(t,e,n){h.between(2,3,arguments);var r={select:y(t),from:y(e)};return void 0!==n&&(r.default=y(n)),new o(r)},SelectAll:function(t,e){return h.exact(2,arguments),new o({select_all:y(t),from:y(e)})},Abs:function(t){return h.exact(1,arguments),new o({abs:y(t)})},Add:function(){return h.min(1,arguments),new o({add:y(d(arguments))})},BitAnd:function(){return h.min(1,arguments),new o({bitand:y(d(arguments))})},BitNot:function(t){return h.exact(1,arguments),new o({bitnot:y(t)})},BitOr:function(){return h.min(1,arguments),new o({bitor:y(d(arguments))})},BitXor:function(){return h.min(1,arguments),new o({bitxor:y(d(arguments))})},Ceil:function(t){return h.exact(1,arguments),new o({ceil:y(t)})},Divide:function(){return h.min(1,arguments),new o({divide:y(d(arguments))})},Floor:function(t){return h.exact(1,arguments),new o({floor:y(t)})},Max:function(){return h.min(1,arguments),new o({max:y(d(arguments))})},Min:function(){return h.min(1,arguments),new o({min:y(d(arguments))})},Modulo:function(){return h.min(1,arguments),new o({modulo:y(d(arguments))})},Multiply:function(){return h.min(1,arguments),new o({multiply:y(d(arguments))})},Round:function(t,e){return h.min(1,arguments),e=m(e,null),new o(p({round:y(t)},{precision:y(e)}))},Subtract:function(){return h.min(1,arguments),new o({subtract:y(d(arguments))})},Sign:function(t){return h.exact(1,arguments),new o({sign:y(t)})},Sqrt:function(t){return h.exact(1,arguments),new o({sqrt:y(t)})},Trunc:function(t,e){return h.min(1,arguments),e=m(e,null),new o(p({trunc:y(t)},{precision:y(e)}))},Acos:function(t){return h.exact(1,arguments),new o({acos:y(t)})},Asin:function(t){return h.exact(1,arguments),new o({asin:y(t)})},Atan:function(t){return h.exact(1,arguments),new o({atan:y(t)})},Cos:function(t){return h.exact(1,arguments),new o({cos:y(t)})},Cosh:function(t){return h.exact(1,arguments),new o({cosh:y(t)})},Degrees:function(t){return h.exact(1,arguments),new o({degrees:y(t)})},Exp:function(t){return h.exact(1,arguments),new o({exp:y(t)})},Hypot:function(t,e){return h.min(1,arguments),e=m(e,null),new o(p({hypot:y(t)},{b:y(e)}))},Ln:function(t){return h.exact(1,arguments),new o({ln:y(t)})},Log:function(t){return h.exact(1,arguments),new o({log:y(t)})},Pow:function(t,e){return h.min(1,arguments),e=m(e,null),new o(p({pow:y(t)},{exp:y(e)}))},Radians:function(t){return h.exact(1,arguments),new o({radians:y(t)})},Sin:function(t){return h.exact(1,arguments),new o({sin:y(t)})},Sinh:function(t){return h.exact(1,arguments),new o({sinh:y(t)})},Tan:function(t){return h.exact(1,arguments),new o({tan:y(t)})},Tanh:function(t){return h.exact(1,arguments),new o({tanh:y(t)})},LT:function(){return h.min(1,arguments),new o({lt:y(d(arguments))})},LTE:function(){return h.min(1,arguments),new o({lte:y(d(arguments))})},GT:function(){return h.min(1,arguments),new o({gt:y(d(arguments))})},GTE:function(){return h.min(1,arguments),new o({gte:y(d(arguments))})},And:function(){return h.min(1,arguments),new o({and:y(d(arguments))})},Or:function(){return h.min(1,arguments),new o({or:y(d(arguments))})},Not:function(t){return h.exact(1,arguments),new o({not:y(t)})},ToString:function(t){return h.exact(1,arguments),new o({to_string:y(t)})},ToNumber:function(t){return h.exact(1,arguments),new o({to_number:y(t)})},ToTime:function(t){return h.exact(1,arguments),new o({to_time:y(t)})},ToSeconds:function(t){return h.exact(1,arguments),new o({to_seconds:y(t)})},ToMicros:function(t){return h.exact(1,arguments),new o({to_micros:y(t)})},ToMillis:function(t){return h.exact(1,arguments),new o({to_millis:y(t)})},DayOfMonth:function(t){return h.exact(1,arguments),new o({day_of_month:y(t)})},DayOfWeek:function(t){return h.exact(1,arguments),new o({day_of_week:y(t)})},DayOfYear:function(t){return h.exact(1,arguments),new o({day_of_year:y(t)})},Second:function(t){return h.exact(1,arguments),new o({second:y(t)})},Minute:function(t){return h.exact(1,arguments),new o({minute:y(t)})},Hour:function(t){return h.exact(1,arguments),new o({hour:y(t)})},Month:function(t){return h.exact(1,arguments),new o({month:y(t)})},Year:function(t){return h.exact(1,arguments),new o({year:y(t)})},ToDate:function(t){return h.exact(1,arguments),new o({to_date:y(t)})},wrap:y}},function(t,e,n){"use strict";function r(t){this.raw=t}r.prototype.toJSON=function(){return this.raw};var i=["Do","Call","Union","Intersection","Difference","Equals","Add","BitAnd","BitOr","BitXor","Divide","Max","Min","Modulo","Multiply","Subtract","LT","LTE","GT","GTE","And","Or"],o={is_nonempty:"is_non_empty",lt:"LT",lte:"LTE",gt:"GT",gte:"GTE"},s=function(t,e){t instanceof r&&(t=t.raw);var n=typeof t;if("string"===n)return'"'+t+'"';if("symbol"===n||"number"===n||"boolean"===n)return t.toString();if("undefined"===n)return"undefined";if(null===t)return"null";var u=function(t){return"{"+Object.keys(t).map(function(e){return e+": "+s(t[e])}).join(", ")+"}"},a=function(t,e){return t.map(function(t){return e(t)}).join(", ")};if(Array.isArray(t)){var c=a(t,s);return-1!=i.indexOf(e)?c:"["+c+"]"}if("let"in t&&"in"in t){return"Let("+(Array.isArray(t.let)?"["+a(t.let,u)+"]":u(t.let))+", "+s(t.in)+")"}if("object"in t)return u(t.object);var l=Object.keys(t),f=l[0];f in o&&(f=o[f]),f=f.split("_").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join("");var h=l.map(function(e){var n=t[e];return s(n,f)}).join(", ");return f+"("+h+")"};r.toString=s,t.exports=r},function(t,e,n){t.exports=n(2).deprecate},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function s(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,u,a=s(t),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))i.call(n,l)&&(a[l]=n[l]);if(r){u=r(n);for(var f=0;f<u.length;f++)o.call(n,u[f])&&(a[u[f]]=n[u[f]])}}return a}},function(t,e,n){"use strict";var r=n(3);function i(t,e){if("object"!=typeof e||null===e)return e;if("@ref"in e){var n=e["@ref"];if(!("collection"in n||"database"in n))return r.Native.fromName(n.id);var o=i("collection",n.collection),s=i("database",n.database);return new r.Ref(n.id,o,s)}return"@obj"in e?e["@obj"]:"@set"in e?new r.SetRef(e["@set"]):"@ts"in e?new r.FaunaTime(e["@ts"]):"@date"in e?new r.FaunaDate(e["@date"]):"@bytes"in e?new r.Bytes(e["@bytes"]):"@query"in e?new r.Query(e["@query"]):e}t.exports={toJSON:function(t,e){return(e=void 0!==e&&e)?JSON.stringify(t,null,"  "):JSON.stringify(t)},parseJSON:function(t){return JSON.parse(t,i)}}},function(t,e,n){"use strict";function r(t,e,n,r,i,o,s,u,a,c,l,f){this.client=t,this.method=e,this.path=n,this.query=r,this.requestRaw=i,this.requestContent=o,this.responseRaw=s,this.responseContent=u,this.statusCode=a,this.responseHeaders=c,this.startTime=l,this.endTime=f}Object.defineProperty(r.prototype,"auth",{get:function(){return this.client._secret}}),Object.defineProperty(r.prototype,"timeTaken",{get:function(){return this.endTime-this.startTime}}),t.exports=r},function(t,e,n){"use strict";var r=n(4),i=n(7),o=n(11).Promise;function s(t,e,n){void 0===n&&(n={}),this.reverse=!1,this.params={},this.before=void 0,this.after=void 0,i(this.params,n),"before"in n?(this.before=n.before,delete this.params.before):"after"in n&&(this.after=n.after,delete this.params.after),this.client=t,this.set=e,this._faunaFunctions=[]}s.prototype.map=function(t){var e=this._clone();return e._faunaFunctions.push(function(e){return r.Map(e,t)}),e},s.prototype.filter=function(t){var e=this._clone();return e._faunaFunctions.push(function(e){return r.Filter(e,t)}),e},s.prototype.each=function(t){return this._retrieveNextPage(this.after,!1).then(this._consumePages(t,!1))},s.prototype.eachReverse=function(t){return this._retrieveNextPage(this.before,!0).then(this._consumePages(t,!0))},s.prototype.previousPage=function(){return this._retrieveNextPage(this.before,!0).then(this._adjustCursors.bind(this))},s.prototype.nextPage=function(){return this._retrieveNextPage(this.after,!1).then(this._adjustCursors.bind(this))},s.prototype._adjustCursors=function(t){return void 0!==t.after&&(this.after=t.after),void 0!==t.before&&(this.before=t.before),t.data},s.prototype._consumePages=function(t,e){var n=this;return function(r){var i,s=[];return r.data.forEach(function(t){t.document&&(t.instance=t.document),t.value&&t.value.document&&(t.value.instance=t.value.document),s.push(t)}),t(s),void 0!==(i=e?r.before:r.after)?n._retrieveNextPage(i,e).then(n._consumePages(t,e)):o.resolve()}},s.prototype._retrieveNextPage=function(t,e){var n={};i(n,this.params),void 0!==t?e?n.before=t:n.after=t:e&&(n.before=null);var o=r.Paginate(this.set,n);return this._faunaFunctions.length>0&&this._faunaFunctions.forEach(function(t){o=t(o)}),this.client.query(o)},s.prototype._clone=function(){return Object.create(s.prototype,{client:{value:this.client},set:{value:this.set},_faunaFunctions:{value:this._faunaFunctions},before:{value:this.before},after:{value:this.after}})},t.exports=s},function(t,e,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var r;r=function(){"use strict";function t(t){return"function"==typeof t}var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=0,r=void 0,i=void 0,o=function(t,e){h[n]=t,h[n+1]=e,2===(n+=2)&&(i?i(p):v())},s="undefined"!=typeof window?window:void 0,u=s||{},a=u.MutationObserver||u.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var t=setTimeout;return function(){return t(p,1)}}var h=new Array(1e3);function p(){for(var t=0;t<n;t+=2){(0,h[t])(h[t+1]),h[t]=void 0,h[t+1]=void 0}n=0}var d,w,m,y,v=void 0;function _(t,e){var n=this,r=new this.constructor(x);void 0===r[g]&&P(r);var i=n._state;if(i){var s=arguments[i-1];o(function(){return N(i,r,s,n._result)})}else R(n,r,t,e);return r}function b(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(x);return T(e,t),e}c?v=function(){return process.nextTick(p)}:a?(w=0,m=new a(p),y=document.createTextNode(""),m.observe(y,{characterData:!0}),v=function(){y.data=w=++w%2}):l?((d=new MessageChannel).port1.onmessage=p,v=function(){return d.port2.postMessage(0)}):v=void 0===s?function(){try{var t=Function("return this")().require("vertx");return void 0!==(r=t.runOnLoop||t.runOnContext)?function(){r(p)}:f()}catch(t){return f()}}():f();var g=Math.random().toString(36).substring(2);function x(){}var C=void 0,S=1,O=2;function A(e,n,r){n.constructor===e.constructor&&r===_&&n.constructor.resolve===b?function(t,e){e._state===S?j(t,e._result):e._state===O?q(t,e._result):R(e,void 0,function(e){return T(t,e)},function(e){return q(t,e)})}(e,n):void 0===r?j(e,n):t(r)?function(t,e,n){o(function(t){var r=!1,i=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,function(n){r||(r=!0,e!==n?T(t,n):j(t,n))},function(e){r||(r=!0,q(t,e))},t._label);!r&&i&&(r=!0,q(t,i))},t)}(e,n,r):j(e,n)}function T(t,e){if(t===e)q(t,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(r=e),null===r||"object"!==i&&"function"!==i)j(t,e);else{var n=void 0;try{n=e.then}catch(e){return void q(t,e)}A(t,e,n)}var r,i}function E(t){t._onerror&&t._onerror(t._result),k(t)}function j(t,e){t._state===C&&(t._result=e,t._state=S,0!==t._subscribers.length&&o(k,t))}function q(t,e){t._state===C&&(t._state=O,t._result=e,o(E,t))}function R(t,e,n,r){var i=t._subscribers,s=i.length;t._onerror=null,i[s]=e,i[s+S]=n,i[s+O]=r,0===s&&t._state&&o(k,t)}function k(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,i=void 0,o=t._result,s=0;s<e.length;s+=3)r=e[s],i=e[s+n],r?N(n,r,i,o):i(o);t._subscribers.length=0}}function N(e,n,r,i){var o=t(r),s=void 0,u=void 0,a=!0;if(o){try{s=r(i)}catch(t){a=!1,u=t}if(n===s)return void q(n,new TypeError("A promises callback cannot return that same promise."))}else s=i;n._state!==C||(o&&a?T(n,s):!1===a?q(n,u):e===S?j(n,s):e===O&&q(n,s))}var D=0;function P(t){t[g]=D++,t._state=void 0,t._result=void 0,t._subscribers=[]}var F=function(){function t(t,n){this._instanceConstructor=t,this.promise=new t(x),this.promise[g]||P(this.promise),e(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&j(this.promise,this._result))):q(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===C&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===b){var i=void 0,o=void 0,s=!1;try{i=t.then}catch(t){s=!0,o=t}if(i===_&&t._state!==C)this._settledAt(t._state,e,t._result);else if("function"!=typeof i)this._remaining--,this._result[e]=t;else if(n===L){var u=new n(x);s?q(u,o):A(u,t,i),this._willSettleAt(u,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===C&&(this._remaining--,t===O?q(r,n):this._result[e]=n),0===this._remaining&&j(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;R(t,void 0,function(t){return n._settledAt(S,e,t)},function(t){return n._settledAt(O,e,t)})},t}(),L=function(){function e(t){this[g]=D++,this._result=this._state=void 0,this._subscribers=[],x!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e(function(e){T(t,e)},function(e){q(t,e)})}catch(e){q(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):this.then(e,e)},e}();return L.prototype.then=_,L.all=function(t){return new F(this,t).promise},L.race=function(t){var n=this;return e(t)?new n(function(e,r){for(var i=t.length,o=0;o<i;o++)n.resolve(t[o]).then(e,r)}):new n(function(t,e){return e(new TypeError("You must pass an array to race."))})},L.resolve=b,L.reject=function(t){var e=new this(x);return q(e,t),e},L._setScheduler=function(t){i=t},L._setAsap=function(t){o=t},L._asap=o,L.polyfill=function(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=L},L.Promise=L,L},t.exports=r()},function(t,e,n){t.exports={Client:n(13),Expr:n(5),PageHelper:n(10),RequestResult:n(9),clientLogger:n(20),errors:n(1),values:n(3),query:n(4)}},function(t,e,n){"use strict";var r=n(14),i=n(15),o=n(1),s=n(4),u=n(3),a=n(8),c=n(9),l=n(19),f=n(10),h=n(11).Promise;function p(t){var e=l.applyDefaults(t,{domain:"db.fauna.com",scheme:"https",port:null,secret:null,timeout:60,observer:null});null===e.port&&(e.port="https"===e.scheme?443:80),this._baseUrl=e.scheme+"://"+e.domain+":"+e.port,this._timeout=Math.floor(1e3*e.timeout),this._secret=e.secret,this._observer=e.observer,this._lastSeen=null}function d(t,e){return void 0===t?e:t}p.prototype.query=function(t){return this._execute("POST","",s.wrap(t))},p.prototype.paginate=function(t,e){return e=d(e,{}),new f(this,t,e)},p.prototype.ping=function(t,e){return this._execute("GET","ping",null,{scope:t,timeout:e})},p.prototype.getLastTxnTime=function(){return this._lastSeen},p.prototype.syncLastTxnTime=function(t){null==this._lastSeen?this._lastSeen=t:this._lastSeen<t&&(this._lastSeen=t)},p.prototype._execute=function(t,e,n,r){r=d(r,null),e instanceof u.Ref&&(e=e.value),null!==r&&(r=l.removeUndefinedValues(r));var i=Date.now(),s=this;return this._performRequest(t,e,n,r).then(function(u,l){var f=Date.now(),h=a.parseJSON(u.text),p=new c(s,t,e,r,l,n,u.text,h,u.status,u.header,i,f);if("x-txn-time"in u.header){var d=parseInt(u.header["x-txn-time"],10);s.syncLastTxnTime(d)}return null!=s._observer&&s._observer(p),o.FaunaHTTPError.raiseForStatusCode(p),h.resource})},p.prototype._performRequest=function(t,e,n,o){var s=i(t,this._baseUrl+"/"+e);o&&s.query(o);var u,a=JSON.stringify(n);return s.type("json"),s.send(a),this._secret&&s.set("Authorization",(u=this._secret,"Basic "+r(u+":"))),this._lastSeen&&s.set("X-Last-Seen-Txn",this._lastSeen),s.set("X-FaunaDB-API-Version","2.7"),s.timeout(this._timeout),new h(function(t,e){s.end(function(n,r){n&&void 0===n.response?e(n):!n||!n.response||n.response.status>=400&&n.response.status<=599?t(r,a):e(n)})})},t.exports=p},function(t,e){t.exports=function(t){return new Buffer(t).toString("base64")}},function(t,e,n){"use strict";var r;global.GENTLY&&(r=GENTLY.hijack(n(16)));const i=r("debug")("superagent"),o=r("formidable"),s=r("form-data"),u=r("./response"),a=r("url").parse,c=r("url").format,l=r("url").resolve;let f=r("methods");const h=r("stream"),p=r("../utils"),d=r("./unzip").unzip,w=r("extend"),m=r("mime"),y=r("https"),v=r("http"),_=r("fs"),b=r("qs"),g=r("zlib"),x=r("util"),C=r("../../package.json"),S=r("../request-base"),O=r("cookiejar");function A(t,n){return"function"==typeof n?new e.Request("GET",t).end(n):1==arguments.length?new e.Request("GET",t):new e.Request(t,n)}function T(){}function E(t){const e=`node-superagent/${C.version}`;t._header={"user-agent":e},t.header={"User-Agent":e}}function j(t,e){h.call(this),"string"!=typeof e&&(e=c(e)),this._agent=!1,this._formData=null,this.method=t,this.url=e,E(this),this.writable=!0,this._redirects=0,this.redirects("HEAD"===t?0:5),this.cookies="",this.qs={},this._query=[],this.qsRaw=this._query,this._redirectList=[],this._streamRequest=!1,this.once("end",this.clearTimeout.bind(this))}function q(t){return/[\/+]json($|[^-\w])/.test(t)}function R(t){return~[301,302,303,305,307,308].indexOf(t)}(e=t.exports=A).Request=j,e.agent=r("./agent"),e.Response=u,m.define({"application/x-www-form-urlencoded":["form","urlencoded","form-data"]},!0),e.protocols={"http:":v,"https:":y},e.serialize={"application/x-www-form-urlencoded":b.stringify,"application/json":JSON.stringify},e.parse=r("./parsers"),x.inherits(j,h),S(j.prototype),j.prototype.attach=function(t,e,n){if(e){if(this._data)throw Error("superagent can't mix .send() and .attach()");let r=n||{};"string"==typeof n&&(r={filename:n}),"string"==typeof e?(r.filename||(r.filename=e),i("creating `fs.ReadStream` instance for file: %s",e),e=_.createReadStream(e)):!r.filename&&e.path&&(r.filename=e.path),this._getFormData().append(t,e,r)}return this},j.prototype._getFormData=function(){return this._formData||(this._formData=new s,this._formData.on("error",t=>{this.emit("error",t),this.abort()})),this._formData},j.prototype.agent=function(t){return arguments.length?(this._agent=t,this):this._agent},j.prototype.type=function(t){return this.set("Content-Type",~t.indexOf("/")?t:m.lookup(t))},j.prototype.accept=function(t){return this.set("Accept",~t.indexOf("/")?t:m.lookup(t))},j.prototype.query=function(t){return"string"==typeof t?this._query.push(t):w(this.qs,t),this},j.prototype.write=function(t,e){const n=this.request();return this._streamRequest||(this._streamRequest=!0),n.write(t,e)},j.prototype.pipe=function(t,e){return this.piped=!0,this.buffer(!1),this.end(),this._pipeContinue(t,e)},j.prototype._pipeContinue=function(t,e){return this.req.once("response",n=>{if(R(n.statusCode)&&this._redirects++!=this._maxRedirects)return this._redirect(n)._pipeContinue(t,e);if(this.res=n,this._emitResponse(),!this._aborted){if(this._shouldUnzip(n)){const r=g.createUnzip();r.on("error",e=>{e&&"Z_BUF_ERROR"===e.code?t.emit("end"):t.emit("error",e)}),n.pipe(r).pipe(t,e)}else n.pipe(t,e);n.once("end",()=>{this.emit("end")})}}),t},j.prototype.buffer=function(t){return this._buffer=!1!==t,this},j.prototype._redirect=function(t){let e=t.headers.location;if(!e)return this.callback(new Error("No location header for redirect"),t);i("redirect %s -> %s",this.url,e),e=l(this.url,e),t.resume();let n=this.req._headers;const r=a(e).host!==a(this.url).host;return 301!=t.statusCode&&302!=t.statusCode||(n=p.cleanHeader(this.req._headers,r),this.method="HEAD"==this.method?"HEAD":"GET",this._data=null),303==t.statusCode&&(n=p.cleanHeader(this.req._headers,r),this.method="GET",this._data=null),delete n.host,delete this.req,delete this._formData,E(this),this._endCalled=!1,this.url=e,this.qs={},this._query.length=0,this.set(n),this.emit("redirect",t),this._redirectList.push(this.url),this.end(this._callback),this},j.prototype.auth=function(t,e,n){1===arguments.length&&(e=""),"object"==typeof e&&null!==e&&(n=e,e=""),n||(n={type:"basic"});var r=function(t){return new Buffer(t).toString("base64")};return this._auth(t,e,n,r)},j.prototype.ca=function(t){return this._ca=t,this},j.prototype.key=function(t){return this._key=t,this},j.prototype.pfx=function(t){return"object"!=typeof t||Buffer.isBuffer(t)?this._pfx=t:(this._pfx=t.pfx,this._passphrase=t.passphrase),this},j.prototype.cert=function(t){return this._cert=t,this},j.prototype.request=function(){if(this.req)return this.req;const t={};try{const t=b.stringify(this.qs,{indices:!1,strictNullHandling:!0});t&&(this.qs={},this._query.push(t)),this._finalizeQueryString()}catch(t){return this.emit("error",t)}let n=this.url;const r=this._retries;if(0!=n.indexOf("http")&&(n=`http://${n}`),n=a(n),!0===/^https?\+unix:/.test(n.protocol)){n.protocol=`${n.protocol.split("+")[0]}:`;const e=n.path.match(/^([^\/]+)(.+)$/);t.socketPath=e[1].replace(/%2F/g,"/"),n.path=e[2]}t.method=this.method,t.port=n.port,t.path=n.path,t.host=n.hostname,t.ca=this._ca,t.key=this._key,t.pfx=this._pfx,t.cert=this._cert,t.passphrase=this._passphrase,t.agent=this._agent;const i=e.protocols[n.protocol],o=this.req=i.request(t);if(o.setNoDelay(!0),"HEAD"!=t.method&&o.setHeader("Accept-Encoding","gzip, deflate"),this.protocol=n.protocol,this.host=n.host,o.once("drain",()=>{this.emit("drain")}),o.once("error",t=>{this._aborted||this._retries===r&&(this.response||this.callback(t))}),n.auth){const t=n.auth.split(":");this.auth(t[0],t[1])}this.username&&this.password&&this.auth(this.username,this.password);for(const t in this.header)this.header.hasOwnProperty(t)&&o.setHeader(t,this.header[t]);if(this.cookies)if(this.header.hasOwnProperty("cookie")){const t=new O.CookieJar;t.setCookies(this.header.cookie.split(";")),t.setCookies(this.cookies.split(";")),o.setHeader("Cookie",t.getCookies(O.CookieAccessInfo.All).toValueString())}else o.setHeader("Cookie",this.cookies);return o},j.prototype.callback=function(t,e){if(this._shouldRetry(t,e))return this._retry();const n=this._callback||T;if(this.clearTimeout(),this.called)return console.warn("superagent: double callback bug");if(this.called=!0,!t)try{if(!this._isResponseOK(e)){let n="Unsuccessful HTTP response";e&&(n=v.STATUS_CODES[e.status]||n),(t=new Error(n)).status=e?e.status:void 0}}catch(e){t=e}if(!t)return n(null,e);t.response=e,this._maxRetries&&(t.retries=this._retries-1),t&&this.listeners("error").length>0&&this.emit("error",t),n(t,e)},j.prototype._isHost=function(t){return Buffer.isBuffer(t)||t instanceof h||t instanceof s},j.prototype._emitResponse=function(t,e){const n=new u(this);return this.response=n,n.redirects=this._redirectList,void 0!==t&&(n.body=t),n.files=e,this.emit("response",n),n},j.prototype.end=function(t){return this.request(),i("%s %s",this.method,this.url),this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=t||T,this._end()},j.prototype._end=function(){let t=this._data;const n=this.req;let r=this._buffer;const s=this.method;if(this._setTimeouts(),"HEAD"!=s&&!n._headerSent){if("string"!=typeof t){let r=n.getHeader("Content-Type");r&&(r=r.split(";")[0]);let i=e.serialize[r];!i&&q(r)&&(i=e.serialize["application/json"]),i&&(t=i(t))}t&&!n.getHeader("Content-Length")&&n.setHeader("Content-Length",Buffer.isBuffer(t)?t.length:Buffer.byteLength(t))}n.once("response",t=>{if(i("%s %s -> %s",this.method,this.url,t.statusCode),this._responseTimeoutTimer&&clearTimeout(this._responseTimeoutTimer),this.piped)return;const s=this._maxRedirects,u=p.type(t.headers["content-type"]||"")||"text/plain",a=u.split("/")[0],c="multipart"==a,l=R(t.statusCode);let f=this._parser;const h=this._responseType;if(this.res=t,l&&this._redirects++!=s)return this._redirect(t);if("HEAD"==this.method)return this.emit("end"),void this.callback(null,this._emitResponse());if(this._shouldUnzip(t)&&d(n,t),!f)if(h)f=e.parse.image,r=!0;else if(c){const t=new o.IncomingForm;f=t.parse.bind(t),r=!0}else!function(t){const e=t.split("/")[0];return"image"==e||"video"==e}(u)?e.parse[u]?f=e.parse[u]:"text"==a?(f=e.parse.text,r=!1!==r):q(u)?(f=e.parse["application/json"],r=!1!==r):r&&(f=e.parse.text):(f=e.parse.image,r=!0);(void 0===r&&function(t){const e=t.split("/"),n=e[0],r=e[1];return"text"==n||"x-www-form-urlencoded"==r}(u)||q(u))&&(r=!0);let w=!1;if(r){let e=this._maxResponseSize||2e8;t.on("data",n=>{if((e-=n.byteLength||n.length)<0){const e=Error("Maximum response size reached");e.code="ETOOLARGE",w=!1,t.destroy(e)}})}if(f)try{w=r,f(t,(t,e,n)=>{if(!this.timedout)return t&&!this._aborted?this.callback(t):void(w&&(this.emit("end"),this.callback(null,this._emitResponse(e,n))))})}catch(t){return void this.callback(t)}if(this.res=t,r)t.once("error",t=>{w=!1,this.callback(t,null)}),w||t.once("end",()=>{i("end %s %s",this.method,this.url),this.emit("end"),this.callback(null,this._emitResponse())});else{if(i("unbuffered %s %s",this.method,this.url),this.callback(null,this._emitResponse()),c)return;t.once("end",()=>{i("end %s %s",this.method,this.url),this.emit("end")})}}),this.emit("request",this);const u=()=>{const t=n.getHeader("Content-Length");let e=0;const r=new h.Transform;return r._transform=(n,r,i)=>{e+=n.length,this.emit("progress",{direction:"upload",lengthComputable:!0,loaded:e,total:t}),i(null,n)},r},a=this._formData;if(a){const t=a.getHeaders();for(const e in t)i('setting FormData header: "%s: %s"',e,t[e]),n.setHeader(e,t[e]);a.getLength((t,e)=>{i("got FormData Content-Length: %s",e),"number"==typeof e&&n.setHeader("Content-Length",e),a.pipe(u()).pipe(n)})}else Buffer.isBuffer(t)?(t=>{const e=new h.Readable,n=t.length,r=n%16384,i=n-r;for(let n=0;n<i;n+=16384){const r=t.slice(n,n+16384);e.push(r)}if(r>0){const n=t.slice(-r);e.push(n)}return e.push(null),e})(t).pipe(u()).pipe(n):n.end(t);return this},j.prototype._shouldUnzip=t=>204!==t.statusCode&&304!==t.statusCode&&("0"!==t.headers["content-length"]&&/^\s*(?:deflate|gzip)\s*$/.test(t.headers["content-encoding"])),-1==f.indexOf("del")&&(f=f.slice(0)).push("del"),f.forEach(t=>{const e=t;t=(t="del"==t?"delete":t).toUpperCase(),A[e]=(e,n,r)=>{const i=A(t,e);return"function"==typeof n&&(r=n,n=null),n&&("GET"===t||"HEAD"===t?i.query(n):i.send(n)),r&&i.end(r),i}})},function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=16},function(t,e,n){"use strict";t.exports=function(t){if("function"!=typeof t)throw new Error("Could not parse function signature for injection dependencies: Object is not a function");if(!t.length)return[];var e=/^()\(?([^)=]*)\)? *=>/.exec(t+"")||/^[^(]+([^ \(]*) *\(([^\)]*)\)/.exec(t+"");if(!e)throw new Error("Could not parse function signature for injection dependencies: "+t);var n=e[2].replace(/\/\*[\S\s]*?\*\//g," ").replace(/\/\/.*/g," ");function r(t,e,n){return e+n.split(",").map(function(t){return t&&t.trim()}).filter(Boolean).join("@")}return(n=(n=n.replace(/(\{)([^}]*)\}/g,r)).replace(/(\[)([^}]*)\]/g,r)).split(",").map(function(t){return t&&t.trim()}).map(function(t){return"{"===t[0]?t.substring(1).split("@"):"["===t[0]?{items:t.substring(1).split("@")}:t}).filter(Boolean)}},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=c(t),r=n[0],s=n[1],u=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,s)),a=0,l=s>0?r-4:r,f=0;f<l;f+=4)e=i[t.charCodeAt(f)]<<18|i[t.charCodeAt(f+1)]<<12|i[t.charCodeAt(f+2)]<<6|i[t.charCodeAt(f+3)],u[a++]=e>>16&255,u[a++]=e>>8&255,u[a++]=255&e;2===s&&(e=i[t.charCodeAt(f)]<<2|i[t.charCodeAt(f+1)]>>4,u[a++]=255&e);1===s&&(e=i[t.charCodeAt(f)]<<10|i[t.charCodeAt(f+1)]<<4|i[t.charCodeAt(f+2)]>>2,u[a++]=e>>8&255,u[a++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,u=n-i;s<u;s+=16383)o.push(l(t,s,s+16383>u?u:s+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,a=s.length;u<a;++u)r[u]=s[u],i[s.charCodeAt(u)]=u;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i,o,s=[],u=e;u<n;u+=3)i=(t[u]<<16&16711680)+(t[u+1]<<8&65280)+(255&t[u+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e,n){"use strict";t.exports={applyDefaults:function(t,e){var n={};for(var r in t){if(!(r in e))throw new Error("No such option "+r);n[r]=t[r]}for(var i in e)i in n||(n[i]=e[i]);return n},removeUndefinedValues:function(t){var e={};for(var n in t){var r=t[n];void 0!==r&&(e[n]=r)}return e}}},function(t,e,n){"use strict";var r=n(8);function i(t){var e=t.query,n=t.method,r=t.path,i=t.requestContent,s=t.responseHeaders,u=t.responseContent,a=t.statusCode,c=t.timeTaken,l="";function f(t){l+=t}return f("Fauna "+n+" /"+r+function(t){if(null==t)return"";var e=Object.keys(t);if(0===e.length)return"";return"?"+e.map(function(e){return e+"="+t[e]}).join("&")}(e)+"\n"),null!=i&&f("  Request JSON: "+o(i)+"\n"),f("  Response headers: "+o(s)+"\n"),f("  Response JSON: "+o(u)+"\n"),f("  Response ("+a+"): Network latency "+c+"ms\n"),l}function o(t){return r.toJSON(t,!0).split("\n").join("\n  ")}t.exports={logger:function(t){return function(e){return t(i(e))}},showRequestResult:i}},,,,,,,,,,,,,,,function(t,e,n){const r=n(12),i=r.query,o=new r.Client({secret:process.env.FAUNADB_SERVER_SECRET});e.handler=(t,e,n)=>{console.log("Function `price-read` invoked");const r=JSON.parse(t.body);return o.query(i.Paginate(i.Match(i.Index("price-by-sku"),r.sku))).then(t=>{const e=t.data[0][1];return n(null,{statusCode:200,body:JSON.stringify({price:e})})}).catch(t=>(console.log("error",t),n(null,{statusCode:400,body:JSON.stringify(t)})))}}]));